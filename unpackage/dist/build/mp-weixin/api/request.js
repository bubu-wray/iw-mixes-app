"use strict";const e=require("../common/vendor.js"),o=(o,t,n)=>{const i=e.index.getStorageSync("iwtoken");if(console.log("iwtoken"+i),i||o.includes("login"))return new Promise(((s,c)=>{e.index.request({url:"https://api.itwray.com/iw-eat"+o,method:t,data:n,header:{iwtoken:i},success:o=>{console.log("统一响应"),console.log(o.data);const t=o.data;if(null!=t)return 401==t.code?(e.index.removeStorageSync("iwtoken"),void e.index.reLaunch({url:"/pages/login/login"})):void(200==t.code?s(t):e.index.showToast({icon:"none",title:t.message}));e.index.showToast({icon:"exception",title:"数据加载异常"})},fail:e=>{console.log("请求失败"),console.log(e),c(e)}})}));e.index.reLaunch({url:"/pages/login/login"})};const t=new class{async get(e){try{return await o(e,"get",{})}catch(t){throw t}}async post(e,t){try{return await o(e,"post",t)}catch(n){throw n}}};exports.http=t;
