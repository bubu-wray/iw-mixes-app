"use strict";const e=require("../../common/vendor.js"),a=require("../../stores/cart.js"),s=require("../../api/request.js");if(!Array){(e.resolveComponent("uni-col")+e.resolveComponent("uni-icons")+e.resolveComponent("uni-row")+e.resolveComponent("uni-load-more"))()}Math||((()=>"../../uni_modules/uni-row/components/uni-col/uni-col.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-row/components/uni-row/uni-row.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+n)();const n=()=>"./cart.js",t={__name:"dishes",setup(n){const t=e.ref([]),i=e.ref("more"),o=e.ref(!1),d=a.useCartStore(),r=e.reactive({pageParam:{currentPage:1,pageSize:10,dishesType:0},list:[]}),c={contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多菜品了"};t.value=[{dishesType:0,name:"全部",selected:!0},{dishesType:1,name:"荤菜",selected:!1},{dishesType:2,name:"素菜",selected:!1},{dishesType:3,name:"荤素搭配",selected:!1}];const p=e=>({marginBottom:"10px",fontSize:"16px",backgroundColor:e.selected?"lightblue":"transparent"});e.onLoad((()=>{l(0)}));const u=e=>{o.value=!0,i.value="loading",s.http.post("/dishes/page",r.pageParam).then((e=>{e.data.records&&e.data.records.length==r.pageParam.pageSize?i.value="more":i.value="noMore",r.list=[...r.list,...e.data.records]})).catch((e=>{i.value="more"})).finally((()=>{o.value=!1}))},l=e=>{r.pageParam.currentPage=1,r.pageParam.pageSize=10,r.pageParam.dishesType=e,r.list=[],t.value.forEach((a=>{a.selected=a.dishesType===e})),u()};return(a,s)=>e.e({a:e.f(t.value,((a,s,n)=>({a:e.t(a.name),b:a.dishesType,c:e.o((e=>l(a.dishesType)),a.dishesType),d:e.s(p(a))}))),b:e.p({span:6}),c:r.list.length>0},r.list.length>0?{d:e.f(r.list,((a,s,n)=>e.e({a:a.dishesImage,b:a.dishesName,c:"5c452fad-4-"+n+",5c452fad-3-"+n,d:e.t(a.dishesName),e:e.t(a.difficultyFactor),f:e.t(a.useTime),g:e.t(a.prices),h:"5c452fad-7-"+n+",5c452fad-6-"+n,i:e.unref(d).cartItems.find((e=>e.id===a.id))},e.unref(d).cartItems.find((e=>e.id===a.id))?{j:"5c452fad-9-"+n+",5c452fad-8-"+n,k:e.p({type:"minus",size:"30"}),l:e.o((e=>(e=>{d.subtractItem(e)})(a)),a.id)}:{m:"5c452fad-10-"+n+",5c452fad-8-"+n,n:e.p({type:"plus-filled",size:"30"}),o:e.o((e=>(e=>{d.addItem(e)})(a)),a.id)},{p:"5c452fad-8-"+n+",5c452fad-6-"+n,q:"5c452fad-6-"+n+",5c452fad-5-"+n,r:"5c452fad-5-"+n+",5c452fad-3-"+n,s:"5c452fad-3-"+n+",5c452fad-2",t:a.id,v:e.o((s=>{return n=a.id,void e.index.navigateTo({url:"/pages/dishes/dishes-detail?operate=edit&id="+n});var n}),a.id)}))),e:e.p({span:12}),f:e.p({span:18}),g:e.p({span:6}),h:e.p({span:12}),i:e.p({status:i.value,contentText:c})}:{},{j:o.value,k:e.o((e=>l(r.pageParam.dishesType))),l:e.o((e=>(r.pageParam.currentPage++,void u()))),m:e.p({span:18})})}};wx.createPage(t);
